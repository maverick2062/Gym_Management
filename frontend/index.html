<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gym Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">

    <div id="auth-view" class="flex items-center justify-center min-h-screen">
        <div class="w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-md">
            <h2 id="auth-title" class="text-2xl font-bold text-center text-gray-900">Sign in to your account</h2>
            <p id="auth-subtitle" class="text-sm text-center">
                Or <a href="#" id="toggle-auth-mode" class="font-medium text-indigo-600 hover:text-indigo-500">create a new account</a>
            </p>
            
            <form id="auth-form" class="space-y-6">
                <div id="name-field" class="hidden">
                    <label for="name" class="text-sm font-medium text-gray-700">Full Name</label>
                    <input id="name" name="name" type="text" class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div>
                    <label for="email" class="text-sm font-medium text-gray-700">Email</label>
                    <input id="email" name="email" type="email" required class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="you@example.com">
                </div>
                <div>
                    <label for="password" class="text-sm font-medium text-gray-700">Password</label>
                    <input id="password" name="password" type="password" required class="w-full px-3 py-2 mt-1 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" placeholder="••••••••">
                </div>
                <div>
                    <button type="submit" id="auth-button" class="w-full px-4 py-2 text-sm font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        Sign in
                    </button>
                </div>
            </form>
            <p id="auth-error" class="text-sm text-center text-red-600"></p>
        </div>
    </div>

    <div id="dashboard-view" class="hidden">
        </div>

    <script>
        // DOM Elements
        const authView = document.getElementById('auth-view');
        const dashboardView = document.getElementById('dashboard-view');
        const authForm = document.getElementById('auth-form');
        const authError = document.getElementById('auth-error');
        const authTitle = document.getElementById('auth-title');
        const authSubtitle = document.getElementById('auth-subtitle');
        const authButton = document.getElementById('auth-button');
        const nameField = document.getElementById('name-field');
        const toggleAuthModeLink = document.getElementById('toggle-auth-mode');
        
        let isLoginMode = true;

        // --- API Functions ---
        async function loginUser(email, password) {
            // ... (this function is unchanged) ...
        }

        // --- NEW: Function to register a new user ---
        async function registerUser(name, email, password) {
            try {
                const response = await fetch('/api/auth/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ name, email, password })
                });
                const data = await response.json();
                if (!response.ok) {
                    throw new Error(data.error || 'Registration failed.');
                }
                alert('Registration successful! Please log in.');
                toggleMode(true); // Switch back to login mode
            } catch (error) {
                console.error('Registration Error:', error);
                authError.textContent = error.message;
            }
        }

        // --- UI Functions ---
        function toggleMode(forceLogin = null) {
            isLoginMode = (forceLogin !== null) ? forceLogin : !isLoginMode;
            authForm.reset();
            authError.textContent = '';
            if (isLoginMode) {
                authTitle.textContent = 'Sign in to your account';
                authSubtitle.innerHTML = 'Or <a href="#" id="toggle-auth-mode" class="font-medium text-indigo-600 hover:text-indigo-500">create a new account</a>';
                authButton.textContent = 'Sign in';
                nameField.classList.add('hidden');
            } else {
                authTitle.textContent = 'Create a new account';
                authSubtitle.innerHTML = 'Or <a href="#" id="toggle-auth-mode" class="font-medium text-indigo-600 hover:text-indigo-500">sign in to your account</a>';
                authButton.textContent = 'Create Account';
                nameField.classList.remove('hidden');
            }
            // Re-add event listener
            document.getElementById('toggle-auth-mode').addEventListener('click', (e) => {
                e.preventDefault();
                toggleMode();
            });
        }
        
        // --- Event Listeners ---
        authForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const email = authForm.email.value;
            const password = authForm.password.value;
            authError.textContent = '';
            if (isLoginMode) {
                loginUser(email, password);
_            } else {
                const name = authForm.name.value;
                registerUser(name, email, password);
            }
        });

        toggleAuthModeLink.addEventListener('click', (e) => {
            e.preventDefault();
            toggleMode();
        });

    </script>
</body>
</html>